# Wedding Quiz โ Telegram-ะฑะพั ะดะปั ะบะฒะธะทะพะฒ ะฝะฐ ะผะตัะพะฟัะธััะธัั

## ๐ ะะพะบัะผะตะฝัะฐัะธั

ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฝะฐัะพะดะธััั ะฒ [`docs/`](./docs/):

- [**ARCHITECTURE.md**](./docs/ARCHITECTURE.md) โ ะพะฑัะฐั ะฐััะธัะตะบัััะฐ, ััะตะบ, ะฟัะธะฝัะธะฟั
- [**DATABASE.md**](./docs/DATABASE.md) โ ััะตะผะฐ ะะ, ะฒัะต ัะฐะฑะปะธัั, ัะฒัะทะธ, enum-ั
- [**API.md**](./docs/API.md) โ ะฒัะต endpoints, request/response ัะพัะผะฐัั
- [**WEBSOCKET.md**](./docs/WEBSOCKET.md) โ ัะพะฑััะธั WebSocket, ัะพัะผะฐั payload-ะพะฒ
- [**BOT.md**](./docs/BOT.md) โ ะบะพะผะฐะฝะดั ะฑะพัะฐ, flow ะฒะทะฐะธะผะพะดะตะนััะฒะธั, webhook ัะพัะผะฐั
- [**QUIZ-FLOW.md**](./docs/QUIZ-FLOW.md) โ ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ: ะถะธะทะฝะตะฝะฝัะน ัะธะบะป ะบะฒะธะทะฐ, ัะพััะพัะฝะธั, ะฟะตัะตัะพะดั
- [**FRONTEND.md**](./docs/FRONTEND.md) โ ััััะบัััะฐ ะบะพะผะฟะพะฝะตะฝัะพะฒ Admin ะธ TV, ัะพััะธะฝะณ
- [**IMPORT.md**](./docs/IMPORT.md) โ ะปะพะณะธะบะฐ ะธะผะฟะพััะฐ DOCX/ZIP, LLM ะฟัะพะผะฟัั

## ๐ฏ ะััะธัะตะบัััะฐ (ะบัะฐัะบะพ)

```
โโโโโโโโโโโโโโโ
โ  Telegram   โโโโโโโโ
โ     Bot     โ      โ
โโโโโโโโโโโโโโโ      โ
                     โผ
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
โ  Web Admin  โโโถโ  Backend API โโโถโ  PostgreSQL โ
โโโโโโโโโโโโโโโ  โ   + WebSocketโ  โโโโโโโโโโโโโโโ
                 โโโโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโ       โ              โโโโโโโโโโโโโโโ
โ   Web TV    โโโโโโโโโ              โ    Redis    โ
โโโโโโโโโโโโโโโ                      โโโโโโโโโโโโโโโ
```

- **Telegram Bot** โ ะบะฐะฟะธัะฐะฝั ะบะพะผะฐะฝะด: ะฒะฒะพะด ะฝะฐะทะฒะฐะฝะธั ะบะพะผะฐะฝะดั, ะพัะฟัะฐะฒะบะฐ ะพัะฒะตัะพะฒ
- **Web Admin** โ ะฒะตะดััะธะน: ัะฟัะฐะฒะปะตะฝะธะต ะธะณัะพะน, ะฟะตัะตะบะปััะตะฝะธะต ัะปะฐะนะดะพะฒ, ะบะธะบ ะธะณัะพะบะพะฒ
- **Web TV** โ ัะบัะฐะฝ ะดะปั ะทัะธัะตะปะตะน: ัะพะปัะบะพ ะฒะพะฟัะพั โ ัะฐะนะผะตั โ ะพัะฒะตั โ ััะฐัะธััะธะบะฐ (read-only)
- **Backend API** โ ะตะดะธะฝััะฒะตะฝะฝัะน ะธััะพัะฝะธะบ ะธััะธะฝั, ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ

## ๐ ะขะตะบััะธะน ััะฐััั

โ **ะะตะฐะปะธะทะพะฒะฐะฝะพ:**
- ะะพะปะฝัะน ัะธะบะป ะบะฒะธะทะฐ: ัะพะทะดะฐะฝะธะต โ ะธะผะฟะพัั โ ัะตะณะธัััะฐัะธั โ ะธะณัะฐ โ ัะตะทัะปััะฐัั
- ะะผะฟะพัั DOCX + ZIP ัะตัะตะท LLM (OpenRouter API)
- Real-time ัะธะฝััะพะฝะธะทะฐัะธั ัะตัะตะท WebSocket
- Telegram ะฑะพั ะดะปั ะบะพะผะฐะฝะด (grammy, long polling)
- TV ัะบัะฐะฝ ั ะฟะพะปะฝะพัะบัะฐะฝะฝัะผ ัะตะถะธะผะพะผ (1920ร1080)
- ะะดะผะธะฝะบะฐ ะดะปั ะฒะตะดััะตะณะพ
- ะัะตะฝะบะฐ ัะตะบััะพะฒัั ะพัะฒะตัะพะฒ ัะตัะตะท LLM
- ะฃะดะฐะปะตะฝะธะต ะบะฒะธะทะพะฒ
- ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟัะพะฟััะบ ะฟััััั ัะปะฐะนะดะพะฒ (video_warning/video_intro)
- **ะะพะฝัะธะณััะฐัะธั bot username ัะตัะตะท .env** (TELEGRAM_BOT_USERNAME)
- **ะะตะทะพะฟะฐัะฝัะน seed + ะฟะพะปะฝัะน ัะฑัะพั ะะ** (ะดะฒะต ะบะฝะพะฟะบะธ ะฒ ะฐะดะผะธะฝะบะต)
- **ะัะฑะพั ะบะฒะธะทะฐ ะดะปั ะฟะพะบะฐะทะฐ ะฝะฐ ะขะ** (displayedOnTv ัะปะฐะณ, ะบะฝะพะฟะบะฐ "ะัะฒะตััะธ ะฝะฐ ัะบัะฐะฝ")
- **ะฃะปัััะตะฝะฝัะน ัะบัะฐะฝ ัะตะณะธัััะฐัะธะธ** (ะฐะดะฐะฟัะธะฒะฝัะน QR ะบะพะด, ะธะบะพะฝะบะธ ะบะพะผะฐะฝะด, ะณัะฐะดะธะตะฝัั)
- **ะะพัะฐะณะพะฒะพะต ะพัะบัััะธะต ัะตะทัะปััะฐัะพะฒ** (ะผะตััะฐ ะฟะพัะฒะปััััั ะฟะพ ะบะปะธะบั ะธะท ะฐะดะผะธะฝะบะธ, ะฟะพััะดะพะบ 2โ3โโฆโ1)
- **Telegram Bot: ะฒะพะฟัะพั ัะพะปัะบะพ ะฝะฐ ัะปะฐะนะดะต ัะฐะนะผะตัะฐ** (ะฝะฐ ัะปะฐะนะดะต ะฒะพะฟัะพัะฐ ะฑะพั ะผะพะปัะธั)
- **ะะธะทัะฐะปัะฝัะต ัะธะบัั TVResults** (ัะปะพั 1-ะณะพ ะผะตััะฐ ะฒัะตะณะดะฐ ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝ, ะฑะพะบะพะฒัะต ััะพะปะฑัั ะฒััะพะฒะฝะตะฝั ะฟะพ ะฝะธะทั)
- **ะขะตััะพะฒัะต ะฐะณะตะฝัั (ะฑะพัั)** โ ะฐะฒัะพะผะฐัะธัะตัะบะพะต ัะตััะธัะพะฒะฐะฝะธะต ะบะฒะธะทะพะฒ ะฑะตะท ัะตะฐะปัะฝัั ััะฐััะฝะธะบะพะฒ:
  - ะกะพะทะดะฐะฝะธะต 1-20 ะฑะพัะพะฒ ะธะท ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ
  - ะะฒัะพะผะฐัะธัะตัะบะธะต ะพัะฒะตัั ัะตัะตะท 1 ัะตะบัะฝะดั (ัะปััะฐะนะฝะพ ะดะปั choice, 50% ะดะปั text)
  - ะะฐะปะพัะบะฐ "ะะพะบะฐะทัะฒะฐัั ะฝะฐ TV" ะดะปั ัะบัััะธั ะฑะพัะพะฒ ะพั ะทัะธัะตะปะตะน
  - WebSocket ะธะฝัะตะณัะฐัะธั ั ะฐะดะผะธะฝะบะพะน (real-time ะพะฑะฝะพะฒะปะตะฝะธั)
  - ะะฒัะพัะดะฐะปะตะฝะธะต ะฟัะธ ะทะฐะฒะตััะตะฝะธะธ ะบะฒะธะทะฐ
  - ะะทะพะปะธัะพะฒะฐะฝะฝัะน ะผะพะดัะปั, ะปะตะณะบะพ ัะดะฐะปะธัั ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ

- **ะะฐะปะธะดะฐัะธั ะพัะฒะตัะพะฒ + ััะตัะตะฝะธะต ัะตะบััะฐ** (ััะฐะฟ 6): choice ะฟัะพะฒะตััะตั A-H, text ะพะฑัะตะทะฐะตััั ะดะพ 500 ัะธะผะฒะพะปะพะฒ ะธ ะดะพ ะฟะตัะฒัั N ะฒะฐัะธะฐะฝัะพะฒ; weight ััะธััะฒะฐะตััั ะฒ ะฟะพะดััััะต ะพัะบะพะฒ
- **ะกะปะฐะนะดั ยซะกะฟะฐัะธะฑะพยป ะธ ัะธะฝะฐะปัะฝัะน** (ััะฐะฟ 7): ะฟะพัะปะต ัะฐัะบัััะธั ะฒัะตั ัะตะทัะปััะฐัะพะฒ ะฒะตะดััะธะน ะผะพะถะตั ะฟะพะบะฐะทะฐัั ัะปะฐะนะด ยซะกะฟะฐัะธะฑะพยป (`thanks`) ะธ/ะธะปะธ ัะธะฝะฐะปัะฝัะน (`final`); ะบะฝะพะฟะบะธ ะฟะพัะฒะปััััั ัะพะปัะบะพ ะตัะปะธ ะบะฐััะธะฝะบะธ ะทะฐะณััะถะตะฝั; TVThanks ะบะพะผะฟะพะฝะตะฝั; ะธะผะฟะพัั ZIP ัะฐัะฟะพะทะฝะฐัั thanksSlide/finalSlide ะฐะฒัะพะผะฐัะธัะตัะบะธ
- **ะญะบัััะฐ-ัะปะฐะนะดั** (ััะฐะฟ 8): ัะธะฟ `extra` ะฒ ัะฐะฑะปะธัะต `slides`; ะฟะพััะดะพะบ ัะตัะตะท `sort_order`; ะฝะฐะฒะธะณะฐัะธั order-based ะฟะพ `currentSlideId`; AdminForm ะฟะพะดะดะตัะถะธะฒะฐะตั ะดะพะฑะฐะฒะปะตะฝะธะต/ัะดะฐะปะตะฝะธะต/upload extras; TV ะฟะพะบะฐะทัะฒะฐะตั fullscreen; ะธะผะฟะพัั ZIP ัะพััะฐะฝัะตั extras ะฒ DB
- **Drag & drop ะดะปั ัะปะฐะนะดะพะฒ**: `SlideStrip.jsx` (ะณะพัะธะทะพะฝัะฐะปัะฝะฐั ะปะตะฝัะฐ ะดะปั ImportPreview โ ะพัะฝะพะฒะฝะฐั ะปะตะฝัะฐ + ะฟัะป ะฝะตะธัะฟะพะปัะทะพะฒะฐะฝะฝัั ัะบััั; ะฟะตัะตัะฐัะธะป ะธะท ะฟัะปะฐ โ ะฒััะฐัั ะฒ ะปะตะฝัั; ะพััะฐะปัะฝัะต ะฟัะธ ัะพััะฐะฝะตะฝะธะธ ะฒัะฑัะฐััะฒะฐัััั) ะธ `SlideDndList.jsx` (ะฒะตััะธะบะฐะปัะฝัะน ัะฟะธัะพะบ ั drag handles โฟ ะดะปั QuestionForm); ะฟะพััะดะพะบ ัะพััะฐะฝัะตััั ัะตัะตะท `orderedSlides` ะฒ backend (`@dnd-kit`)

๐ **ะะปะธะถะฐะนัะธะต ะฟะปะฐะฝั** (ัะผ. [`PLAN.md`](./PLAN.md)):

### ะญัะฐะฟ 9
- Web Admin: ัะปัััะธัั seed Demo quiz ะดะปั ะฟะพะบัััะธั ะฒัะตั ะบะตะนัะพะฒ

## ๐ ะกัะตะบ ัะตัะฝะพะปะพะณะธะน

**Backend:**
- Node.js + TypeScript
- Fastify (HTTP + WebSocket)
- Drizzle ORM + PostgreSQL
- OpenRouter API (LLM)

**Telegram Bot** (ะพัะดะตะปัะฝัะน ัะตัะฒะธั `apps/bot/`):
- grammy (long polling)

**Frontend:**
- React (Vite) + React Router
- Tailwind CSS
- WebSocket (real-time)

**ะะตะฟะปะพะน:**
- Docker Compose
- Nginx (ะพะฟัะธะพะฝะฐะปัะฝะพ)

## ๐ก ะัะฐะฒะธะปะฐ ัะฐะฑะพัั

1. **ะะพะบัะผะตะฝัะฐัะธั ะฟะตัะฒะธัะฝะฐ** โ ะฒัะตะณะดะฐ ัะฒะตััะนัั ั `docs/` ะฟะตัะตะด ะธะทะผะตะฝะตะฝะธัะผะธ
2. **ะะดะธะฝ ััะฐะฟ ะทะฐ ัะฐะท** โ ัะตะฐะปะธะทะพะฒัะฒะฐัั ะฟะพ ะพะดะฝะพะผั ััะฐะฟั ะธะท PLAN.md
3. **ะะพะดัะฒะตัะถะดะตะฝะธะต ะฟะพัะปะต ะบะฐะถะดะพะณะพ ััะฐะฟะฐ** โ ะถะดะฐัั OK ะพั ะฟะพะปัะทะพะฒะฐัะตะปั
4. **ะะตะทะพะฟะฐัะฝะพััั** โ ะฝะต ะธัะฟะพะปัะทะพะฒะฐัั ะดะตััััะบัะธะฒะฝัะต git ะบะพะผะฐะฝะดั ะฑะตะท ัะฒะฝะพะณะพ ะทะฐะฟัะพัะฐ
5. **DRY ะฟัะธะฝัะธะฟ** โ ะธัะฟะพะปัะทะพะฒะฐัั service layer, ะธะทะฑะตะณะฐัั ะดัะฑะปะธัะพะฒะฐะฝะธั ะบะพะดะฐ
6. **ะะพัะปะต ะะะะะะะ ะธะทะผะตะฝะตะฝะธั ะบะพะดะฐ** โ ะพะฑัะทะฐัะตะปัะฝะพ ะพะฑะฝะพะฒะธ ะทะฐััะพะฝัััะต ัะฐะนะปั ะฒ docs/, PLAN.md ะธ DONE.md. ะญัะพ ะฝะต ะพะฟัะธะพะฝะฐะปัะฝะพ.
7. **Real-time ะพะฑะฝะพะฒะปะตะฝะธั** โ ะฒัะตะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั WebSocket ะดะปั ัะธะฝััะพะฝะธะทะฐัะธะธ TV ะธ Admin

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
wedding-quiz/
โโโ apps/
โ   โโโ api/              # Backend (Node.js + Fastify)
โ   โ   โโโ src/
โ   โ   โ   โโโ db/       # Drizzle schema, ะผะธะณัะฐัะธะธ
โ   โ   โ   โโโ routes/   # HTTP endpoints
โ   โ   โ   โโโ services/ # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โ   โ   โโโ test-agents/ # ะขะตััะพะฒัะต ะฑะพัั
โ   โ   โโโ Dockerfile
โ   โโโ bot/              # Telegram Bot (grammy, long polling)
โ   โ   โโโ src/
โ   โ   โ   โโโ handlers/ # start, captain
โ   โ   โ   โโโ ws-listener.ts
โ   โ   โ   โโโ api-client.ts
โ   โ   โโโ Dockerfile
โ   โโโ web/              # Frontend (React + Vite)
โ       โโโ src/
โ       โ   โโโ pages/    # Admin, TV, Game
โ       โ   โโโ components/
โ       โ   โโโ api/
โ       โโโ Dockerfile
โโโ docs/                 # ะะพะบัะผะตะฝัะฐัะธั
โโโ PLAN.md               # ะะปะฐะฝ ัะฐะทะฒะธัะธั
โโโ docker-compose.yml
```

## ๐ ะัััััะน ััะฐัั

```bash
# ะะฐะฟััะบ ะฒ dev ัะตะถะธะผะต
docker compose up -d

# ะะตัะตัะพะทะดะฐัั ะะ ะธ seed ะดะฐะฝะฝัะต
docker exec -it wedding-quiz-api-1 npm run db:migrate
docker exec -it wedding-quiz-api-1 npm run seed

# ะะพะณะธ
docker compose logs -f api
```

## ๐ ะะพะปะตะทะฝัะต ัััะปะบะธ

- ะะพะบัะผะตะฝัะฐัะธั: [`docs/`](./docs/)
- ะะปะฐะฝ ัะฐะทะฒะธัะธั: [`PLAN.md`](./PLAN.md)
- ะััะพัะธั ะทะฐะดะฐั: [`DONE.md`](./DONE.md)

---

## ะัะธ ะฝะฐัะฐะปะต ะบะฐะถะดะพะน ัะตััะธะธ
ะะตัะตะด ะปัะฑะพะน ัะฐะฑะพัะพะน ะฟัะพัะธัะฐะน:
1. PLAN.md โ ัะตะบััะธะต ะทะฐะดะฐัะธ
2. DONE.md โ ััะพ ัะถะต ัะดะตะปะฐะฝะพ
3. docs/ โ ัะตะปะตะฒะฐะฝัะฝัะต ัะฐะนะปั ะดะปั ัะตะบััะตะณะพ ััะฐะฟะฐ

## โ๏ธ ะะะะขะะงะะกะะ ะะะะะ
ะะธะบะพะณะดะฐ ะฝะต ััะธัะฐะน ััะฐะฟ ะทะฐะฒะตัััะฝะฝัะผ ะฑะตะท ะพะฑะฝะพะฒะปะตะฝะธั ะดะพะบัะผะตะฝัะฐัะธะธ.
ะัะปะธ ัั ะธะทะผะตะฝะธะป ะฟะพะฒะตะดะตะฝะธะต API โ ะพะฑะฝะพะฒะธ docs/API.md.
ะัะปะธ ัั ะธะทะผะตะฝะธะป ััะตะผั ะะ โ ะพะฑะฝะพะฒะธ docs/DATABASE.md.
ะัะปะธ ัั ะทะฐะฒะตััะธะป ััะฐะฟ ะธะท PLAN.md โ ะฟะตัะตะฝะตัะธ ะตะณะพ ะฒ DONE.md.
ะะตัะตะด ะฝะฐัะฐะปะพะผ ัะฐะฑะพัั ะฒัะตะณะดะฐ ัะธัะฐะน ัะพะพัะฒะตัััะฒัััะธะต ัะฐะทะดะตะปั ะดะพะบัะผะตะฝัะฐัะธะธ ะฒ `docs/`.
